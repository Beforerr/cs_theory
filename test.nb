(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59402,       1333]
NotebookOptionsPosition[     57056,       1288]
NotebookOutlinePosition[     57544,       1307]
CellTagsIndexPosition[     57501,       1304]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Change", " ", "the", " ", "directory", " ", "to", " ", "the", " ", 
    "current", " ", "file", " ", "location"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetDirectory", "@", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.925515930977159*^9, 3.925515930982057*^9}, {
  3.925516602305077*^9, 3.92551661262122*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"c57be7b1-9b08-4fef-857d-8b76f19ba880"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Bx", ":=", 
   RowBox[{"B0", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[CurlyPhi]", "[", "z", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"By", ":=", 
  RowBox[{"B0", " ", 
   RowBox[{"Sin", " ", "[", 
    RowBox[{"\[CurlyPhi]", "[", "z", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u1x", ":=", 
   RowBox[{"u0", " ", 
    RowBox[{"Cos", " ", "[", 
     RowBox[{"\[CurlyPhi]", "[", "z", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u1y", ":=", 
   RowBox[{"u0", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[CurlyPhi]", "[", "z", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.925412766110725*^9, 3.92541276660184*^9}, {
   3.925412824059415*^9, 3.925412885950409*^9}, {3.925413074477766*^9, 
   3.925413079326132*^9}, {3.925413164531788*^9, 3.92541317575103*^9}, {
   3.925413214389052*^9, 3.925413252874668*^9}, {3.925413307541164*^9, 
   3.9254133496389513`*^9}, {3.925413404649241*^9, 3.925413418133523*^9}, 
   3.9254135570036383`*^9, {3.925553677256015*^9, 3.925553678037443*^9}, {
   3.9255537211817293`*^9, 3.925553727559814*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"2a549da3-f222-4fa3-b368-545cb805d6b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"notationRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"B0", "->", 
      SubscriptBox["B", "0"]}], ",", 
     RowBox[{"Bz", "->", 
      SubscriptBox["B", "z"]}], ",", 
     RowBox[{"u0", "->", 
      SubscriptBox["u", "0"]}], ",", 
     RowBox[{"\[CapitalGamma]1", "->", 
      SubscriptBox["\[CapitalGamma]", "1"]}], ",", 
     RowBox[{
      RowBox[{"n", "[", "z", "]"}], "->", 
      SubscriptBox["n", "1"]}], ",", 
     RowBox[{"\[CapitalLambda]z", "->", 
      SubscriptBox["\[CapitalLambda]", "z"]}], ",", 
     RowBox[{"\[CapitalLambda]y", "->", 
      SubscriptBox["\[CapitalLambda]", "y"]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9255136029640093`*^9, 3.925513634461564*^9}, {
  3.92551454034513*^9, 3.925514606821662*^9}, {3.925553324778438*^9, 
  3.925553325359333*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"9f4efdb5-9f57-44e4-a8f0-abf996ab31d8"],

Cell[BoxData[{
 RowBox[{"eqUB", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "\[CapitalLambda]y"}], " ", "u0"}], "B0"], "+", 
       FractionBox["Bz", "\[CapitalGamma]1"]}], ")"}], 
     RowBox[{"n", "[", "z", "]"}]}], "+", 
    FractionBox[
     RowBox[{"\[CapitalLambda]z", " ", "\[CapitalGamma]1"}], "Bz"]}], "==", 
   FractionBox["B0", "u0"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol2", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqUB", ",", "\[CapitalLambda]y"}], " ", "]"}], "//", 
    "First"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.925514509646305*^9, 3.92551452524924*^9}, {
   3.925515124649091*^9, 3.9255151330555687`*^9}, 3.925515237596587*^9, {
   3.9255220617922573`*^9, 3.9255220620567837`*^9}, {3.9255525326611137`*^9, 
   3.925552543560053*^9}, {3.9255525750059433`*^9, 3.925552626097227*^9}, {
   3.925552896513826*^9, 3.9255528987120523`*^9}, {3.925553334878487*^9, 
   3.925553335618177*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"60b358ca-ec4d-4958-93d6-f654c4b1f51e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq\[CurlyPhi]", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[CurlyPhi]", "'"}], "[", "z", "]"}], "==", 
      RowBox[{
       FractionBox["Bz", "\[CapitalGamma]1"], 
       RowBox[{"(", 
        RowBox[{"nInf", "-", 
         RowBox[{"n", "[", "z", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"\[CurlyPhi]", "[", "0", "]"}], "==", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqT", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       SuperscriptBox["\[CapitalGamma]1", "2"], 
       RowBox[{"n", "[", "z", "]"}]], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", "[", "z", "]"}], 
         RowBox[{"T", "[", "z", "]"}]}], ")"}]}]}], "==", 
     RowBox[{
      SuperscriptBox["\[CapitalGamma]1", "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], "T0"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"eq\[CurlyPhi]", ",", "eqT"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", "z_", "]"}], ":=", 
   RowBox[{"1", "+", 
    FractionBox["c", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z", "/", "\[Delta]"}], " ", ")"}], "2"]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesn", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Bz", "->", "1"}], ",", 
     RowBox[{"\[CapitalGamma]1", "->", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       SqrtBox["2"]}]}], ",", 
     RowBox[{"\[Delta]", "->", "1"}], ",", 
     RowBox[{"nInf", "->", "1"}], ",", 
     RowBox[{"u0", "->", 
      FractionBox[
       RowBox[{"\[CapitalGamma]1", " ", "B0"}], 
       RowBox[{"nInf", " ", "Bz"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol1", "=", 
   RowBox[{
    RowBox[{"DSolve", "[", 
     RowBox[{"eqs", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[CurlyPhi]", "[", "z", "]"}], ",", 
        RowBox[{"T", "[", "z", "]"}]}], "}"}], ",", "z"}], "]"}], "//", 
    "First"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"sol1", ",", "sol2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.925422856951825*^9, 3.9254228576656017`*^9}, {
   3.925423265716107*^9, 3.925423300180129*^9}, {3.925423395253827*^9, 
   3.925423395945448*^9}, {3.9254236674819803`*^9, 3.925423678949915*^9}, {
   3.925423778726739*^9, 3.925423781100864*^9}, {3.925424274962288*^9, 
   3.9254242754637213`*^9}, {3.925427298315905*^9, 3.9254275067951603`*^9}, {
   3.925427546389183*^9, 3.925427610811294*^9}, {3.925427874985935*^9, 
   3.925427953717519*^9}, {3.9254279881656733`*^9, 3.925427997634179*^9}, 
   3.925428055872616*^9, {3.925428787691361*^9, 3.925428788617181*^9}, {
   3.925428879414175*^9, 3.9254288867981567`*^9}, {3.925428927475192*^9, 
   3.92542893101134*^9}, {3.9254289754950533`*^9, 3.9254290602777433`*^9}, {
   3.92551430274087*^9, 3.925514337759718*^9}, 3.92551450868923*^9, {
   3.925515154429076*^9, 3.925515156395533*^9}, 3.9255226022748737`*^9, {
   3.9255514258406687`*^9, 3.9255514316521397`*^9}, 3.9255515751597853`*^9, {
   3.925551881136815*^9, 3.925551881472012*^9}, 3.925551946563531*^9, 
   3.925552408874547*^9, {3.92555275733136*^9, 3.925552757777727*^9}, 
   3.925552911118788*^9, 3.9255530454859247`*^9, {3.925553424887714*^9, 
   3.9255534281202602`*^9}, 3.925553549258669*^9, {3.92555378186202*^9, 
   3.925553787848319*^9}, {3.925554074938053*^9, 3.925554102329887*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"1589de5a-f673-450d-9fe5-baabdbfccd22"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]yTemp", "=", 
   RowBox[{"\[CapitalLambda]y", "/.", "sol2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"\[CapitalLambda]yTemp", "//.", "rulesn"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "[", "z", "]"}], ",", "Bx", ",", "By", ",", "u1x", ",", 
     "u1y"}], "}"}], "/.", "sols"}], "//.", "rulesn"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Asymptotic", "[", 
    RowBox[{
     RowBox[{"\[CapitalLambda]yTemp", "//.", "rulesn"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalLambda]z", "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"z", "->", "0"}]}], "}"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.925522404958766*^9, 3.925522497710281*^9}, {
   3.925522578033564*^9, 3.925522578405718*^9}, {3.925522635203743*^9, 
   3.9255226675250673`*^9}, {3.925522741736253*^9, 3.925522752733635*^9}, {
   3.925522815559725*^9, 3.92552284741321*^9}, 3.925522897173204*^9, {
   3.925522928687098*^9, 3.92552293084796*^9}, {3.925522971167804*^9, 
   3.925522982986808*^9}, {3.9255230339953213`*^9, 3.925523100610512*^9}, {
   3.925523146222662*^9, 3.925523177363778*^9}, {3.92555419827042*^9, 
   3.9255542098791323`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"0ee476ad-e9a5-4366-8c40-8c4f2ea34276"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", "c"}], "+", "\[CapitalLambda]z", "+", 
   RowBox[{
    SuperscriptBox["z", "2"], " ", "\[CapitalLambda]z"}]}], 
  RowBox[{"1", "+", "c", "+", 
   SuperscriptBox["z", "2"]}]]], "Output",
 CellChangeTimes->{{3.9255227475713043`*^9, 3.925522758389646*^9}, {
   3.925522818880125*^9, 3.925522847920313*^9}, 3.925522897635708*^9, 
   3.9255229316379232`*^9, {3.925522974805929*^9, 3.925522983579322*^9}, {
   3.925523041250937*^9, 3.92552311574314*^9}, {3.925523146724164*^9, 
   3.925523177928753*^9}, 3.925551440748055*^9, 3.925551894616736*^9, 
   3.925553346782977*^9, 3.925553700868038*^9, 3.925553934266038*^9, {
   3.925554199571398*^9, 3.925554210379263*^9}, 3.9255542831116343`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"6524e740-094b-444b-9944-877c6752f301"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "+", 
    FractionBox["c", 
     RowBox[{"1", "+", 
      SuperscriptBox["z", "2"]}]]}], ",", 
   RowBox[{"B0", " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Pi]", 
         SqrtBox["2"]]}], "-", 
       RowBox[{"2", " ", "c", " ", 
        RowBox[{"ArcTan", "[", "z", "]"}]}]}], 
      SqrtBox["2"]], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "B0"}], " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Pi]", 
         SqrtBox["2"]]}], "-", 
       RowBox[{"2", " ", "c", " ", 
        RowBox[{"ArcTan", "[", "z", "]"}]}]}], 
      SqrtBox["2"]], "]"}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"B0", " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Pi]", 
           SqrtBox["2"]]}], "-", 
         RowBox[{"2", " ", "c", " ", 
          RowBox[{"ArcTan", "[", "z", "]"}]}]}], 
        SqrtBox["2"]], "]"}]}], 
     SqrtBox["2"]]}], ",", 
   FractionBox[
    RowBox[{"B0", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Pi]", 
          SqrtBox["2"]]}], "-", 
        RowBox[{"2", " ", "c", " ", 
         RowBox[{"ArcTan", "[", "z", "]"}]}]}], 
       SqrtBox["2"]], "]"}]}], 
    SqrtBox["2"]]}], "}"}]], "Output",
 CellChangeTimes->{{3.9255227475713043`*^9, 3.925522758389646*^9}, {
   3.925522818880125*^9, 3.925522847920313*^9}, 3.925522897635708*^9, 
   3.9255229316379232`*^9, {3.925522974805929*^9, 3.925522983579322*^9}, {
   3.925523041250937*^9, 3.92552311574314*^9}, {3.925523146724164*^9, 
   3.925523177928753*^9}, 3.925551440748055*^9, 3.925551894616736*^9, 
   3.925553346782977*^9, 3.925553700868038*^9, 3.925553934266038*^9, {
   3.925554199571398*^9, 3.925554210379263*^9}, 3.9255542831137238`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"7f51e274-2f5a-4822-ad3b-8fc2ec5f6c0f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"\[CapitalGamma]e", ":=", 
  RowBox[{"\[CapitalLambda]z", " ", "\[CapitalGamma]1"}]}], "\n", 
 RowBox[{"\[CapitalLambda]x", ":=", "\[CapitalLambda]y"}], "\n", 
 RowBox[{"Jxi", ":=", 
  RowBox[{"\[CapitalLambda]x", " ", 
   RowBox[{"n", "[", "z", "]"}], " ", "u1x"}]}], "\n", 
 RowBox[{"Jyi", ":=", 
  RowBox[{"\[CapitalLambda]y", " ", 
   RowBox[{"n", "[", "z", "]"}], " ", "u1y"}]}], "\n", 
 RowBox[{"Jxe", ":=", 
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[CapitalGamma]e", " ", "Bx"}], ")"}], "/", "Bz"}], 
    ")"}]}]}], "\n", 
 RowBox[{"Jye", ":=", 
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[CapitalGamma]e", " ", "By"}], ")"}], "/", "Bz"}], 
    ")"}]}]}], "\n", 
 RowBox[{"Jx", ":=", 
  RowBox[{"Jxi", "+", "Jxe"}]}], "\n", 
 RowBox[{"Jy", ":=", 
  RowBox[{"Jyi", "+", "Jye"}]}]}], "Input",
 CellChangeTimes->{{3.925428654827257*^9, 3.925428703829526*^9}, {
   3.9254287445982513`*^9, 3.925428753397976*^9}, {3.9254291878202868`*^9, 
   3.925429299513247*^9}, {3.925429413950951*^9, 3.925429438885407*^9}, {
   3.925429476293594*^9, 3.925429486756276*^9}, {3.925429518825975*^9, 
   3.925429572677772*^9}, 3.925429763643013*^9, {3.925553819529254*^9, 
   3.925553827230446*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"43160a05-28e8-481e-a28b-2c0263eb43e1"],

Cell["Normalize the thickness by \[Delta] (let \[Delta]=1) and ", "Text",
 CellChangeTimes->{{3.925424555008294*^9, 
  3.925424585361268*^9}},ExpressionUUID->"51c5f021-c743-4d0a-b04e-\
c3919d509d8b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"B0", "=", "B0i"}], ",", 
       RowBox[{"c", "=", "ci"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p1", "=", 
       RowBox[{"Plot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n", "[", "z", "]"}], ",", "Bx", ",", "By", ",", "u1x", 
              ",", "u1y"}], "}"}], "/.", "sols"}], "//.", "rulesn"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", "zmax"}], ",", "zmax"}], "}"}], ",", 
         RowBox[{"PlotLegends", "->", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            SubscriptBox["B", "x"], ",", 
            SubscriptBox["B", "y"], ",", 
            SubscriptBox["u", "x"], ",", 
            SubscriptBox["u", "y"]}], "}"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<figures/profiles.jpg\>\"", ",", "p1"}], "]"}], ";", 
      "\[IndentingNewLine]", "p1"}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ci", ",", 
       RowBox[{"1", "/", 
        SqrtBox["2"]}]}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"B0i", ",", "2"}], "}"}], ",", "0.5", ",", "5"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zmax", ",", "10"}], "}"}], ",", "5", ",", "30"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9254164605754957`*^9, 3.9254165561881332`*^9}, {
   3.925416610519126*^9, 3.92541662972416*^9}, {3.925416786461187*^9, 
   3.925416814549851*^9}, {3.9254168503349323`*^9, 3.9254169425923033`*^9}, {
   3.925417001977765*^9, 3.9254170709939547`*^9}, {3.92541715557415*^9, 
   3.9254171986572933`*^9}, {3.925417232518881*^9, 3.925417336221422*^9}, {
   3.9254179625719147`*^9, 3.92541801143034*^9}, {3.9254180495309477`*^9, 
   3.925418146579318*^9}, {3.92541818017338*^9, 3.9254181967557*^9}, {
   3.925418250349564*^9, 3.925418262819632*^9}, {3.9254182967049217`*^9, 
   3.925418297232984*^9}, {3.925418359223638*^9, 3.925418370552294*^9}, 
   3.925418415534829*^9, {3.925418450814745*^9, 3.925418486109198*^9}, {
   3.9254185314255323`*^9, 3.925418673944723*^9}, {3.925418712151352*^9, 
   3.925418717704053*^9}, {3.925418774044608*^9, 3.925418777192459*^9}, {
   3.925418835044344*^9, 3.9254188776897717`*^9}, {3.9254189077011223`*^9, 
   3.925419014300803*^9}, {3.925419148458953*^9, 3.9254191853364553`*^9}, {
   3.925419230595738*^9, 3.925419239135539*^9}, {3.925419288610704*^9, 
   3.9254195714733667`*^9}, {3.925419822905548*^9, 3.925419925126189*^9}, {
   3.925419962389594*^9, 3.925419992042966*^9}, {3.925420051908729*^9, 
   3.925420052808859*^9}, {3.925420156510058*^9, 3.925420218782482*^9}, {
   3.92542026286788*^9, 3.925420305746503*^9}, {3.9254204222997007`*^9, 
   3.925420422915584*^9}, {3.9254205003119993`*^9, 3.9254209868233547`*^9}, {
   3.925421022563059*^9, 3.925421051803507*^9}, {3.925421430918481*^9, 
   3.925421480540634*^9}, {3.925421520358873*^9, 3.925421531295055*^9}, {
   3.925421594552346*^9, 3.925421594729486*^9}, {3.925422892931817*^9, 
   3.925422893364554*^9}, {3.925423196468299*^9, 3.92542320936932*^9}, 
   3.925423263017352*^9, {3.925423310929791*^9, 3.925423311374049*^9}, {
   3.925423393837509*^9, 3.9254234026285553`*^9}, {3.9254235885459146`*^9, 
   3.925423591691807*^9}, {3.925423699552156*^9, 3.9254237031208076`*^9}, {
   3.925423819698873*^9, 3.925423821600169*^9}, {3.925423879281558*^9, 
   3.925423906685953*^9}, {3.925423938677681*^9, 3.925423952888595*^9}, {
   3.925424004486443*^9, 3.925424020070026*^9}, {3.9254240522287188`*^9, 
   3.925424065904025*^9}, {3.925424208406871*^9, 3.925424215254168*^9}, {
   3.925424313962063*^9, 3.925424373312769*^9}, {3.925424409819084*^9, 
   3.92542441924771*^9}, {3.925424874826508*^9, 3.925424974870708*^9}, {
   3.925425008976317*^9, 3.9254250145888*^9}, {3.9254276274893417`*^9, 
   3.92542764001719*^9}, {3.925427784485116*^9, 3.925427800164548*^9}, {
   3.9254281608222427`*^9, 3.925428302611627*^9}, {3.925428340368569*^9, 
   3.925428367914418*^9}, {3.925428445663628*^9, 3.925428447470006*^9}, 
   3.92542910117458*^9, {3.925429803680662*^9, 3.925429810389327*^9}, {
   3.9254298744061527`*^9, 3.925429889403797*^9}, {3.925429927192245*^9, 
   3.925429927891159*^9}, {3.925430011317843*^9, 3.925430018938857*^9}, {
   3.925430051477729*^9, 3.9254301280674057`*^9}, {3.925430279041485*^9, 
   3.925430289619129*^9}, {3.925515087636492*^9, 3.925515095889201*^9}, {
   3.925515253112883*^9, 3.9255153326970367`*^9}, {3.9255153896415577`*^9, 
   3.9255154596702147`*^9}, {3.92551557497654*^9, 3.92551557597936*^9}, {
   3.925515821703114*^9, 3.9255158220176353`*^9}, {3.925523385160386*^9, 
   3.925523385275742*^9}, {3.925551454394462*^9, 3.925551548523244*^9}, {
   3.92555158509938*^9, 3.925551589645206*^9}, {3.925551977056233*^9, 
   3.9255519772276917`*^9}, {3.925552796304891*^9, 3.9255528087690763`*^9}, {
   3.925552987851429*^9, 3.925553028525079*^9}, {3.9255530940013247`*^9, 
   3.925553127070208*^9}, {3.9255532478733377`*^9, 3.925553252191896*^9}, {
   3.92555350843708*^9, 3.92555351051764*^9}, {3.9255535548581133`*^9, 
   3.9255535583091593`*^9}, {3.925553709803109*^9, 3.9255537423277817`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"75d50e55-db95-43e3-a1d2-b2204956fced"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`B0i$$ = 2, $CellContext`ci$$ = 2^
    Rational[-1, 2], $CellContext`zmax$$ = 10, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`ci$$], 2^Rational[-1, 2]}, 0, 2}, {{
       Hold[$CellContext`B0i$$], 2}, 0.5, 5}, {{
       Hold[$CellContext`zmax$$], 10}, 5, 30}}, Typeset`size$$ = {
    626., {163., 170.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`B0i$$ = 2, $CellContext`ci$$ = 
        2^Rational[-1, 2], $CellContext`zmax$$ = 10}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Block[{$CellContext`B0 = $CellContext`B0i$$, $CellContext`c = \
$CellContext`ci$$}, $CellContext`p1 = Plot[
           Evaluate[
            ReplaceRepeated[
             ReplaceAll[{
               $CellContext`n[$CellContext`z], $CellContext`Bx, \
$CellContext`By, $CellContext`u1x, $CellContext`u1y}, $CellContext`sols], \
$CellContext`rulesn]], {$CellContext`z, -$CellContext`zmax$$, \
$CellContext`zmax$$}, PlotLegends -> {$CellContext`n, 
             Subscript[$CellContext`B, $CellContext`x], 
             Subscript[$CellContext`B, $CellContext`y], 
             Subscript[$CellContext`u, $CellContext`x], 
             Subscript[$CellContext`u, $CellContext`y]}]; 
        Export["figures/profiles.jpg", $CellContext`p1]; $CellContext`p1], 
      "Specifications" :> {{{$CellContext`ci$$, 2^Rational[-1, 2]}, 0, 
         2}, {{$CellContext`B0i$$, 2}, 0.5, 5}, {{$CellContext`zmax$$, 10}, 5,
          30}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{692., {272., 280.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.92542500208409*^9, 3.925425015618759*^9}, {
   3.925427629204618*^9, 3.925427640841195*^9}, 3.925427674768865*^9, {
   3.9254277869566193`*^9, 3.9254278006186438`*^9}, 3.9254281622576447`*^9, {
   3.925428204587873*^9, 3.925428281049518*^9}, {3.925428340892871*^9, 
   3.925428369354054*^9}, 3.925428447901143*^9, 3.925428481297019*^9, 
   3.9254291017125673`*^9, 3.9254298897933197`*^9, 3.925430019494155*^9, {
   3.925430066263541*^9, 3.925430128584845*^9}, {3.925430269034439*^9, 
   3.9254302900037003`*^9}, 3.925514364013883*^9, 3.9255144386455317`*^9, {
   3.92551508967279*^9, 3.925515096216579*^9}, {3.925515247825965*^9, 
   3.925515296854589*^9}, 3.9255153614957027`*^9, 3.92551546014191*^9, 
   3.925515503647246*^9, 3.925515576452012*^9, {3.925515822494157*^9, 
   3.9255158301131763`*^9}, 3.92551595400246*^9, 3.9255227740986757`*^9, 
   3.92552338586058*^9, 3.925551444495996*^9, {3.925551507464419*^9, 
   3.925551549415502*^9}, {3.925551581830353*^9, 3.925551590064137*^9}, 
   3.9255518975339003`*^9, {3.925551959455484*^9, 3.925552000329249*^9}, 
   3.92555203859713*^9, 3.925552141502647*^9, 3.925552422502459*^9, {
   3.925552784920272*^9, 3.925552785682949*^9}, 3.92555334997208*^9, 
   3.925553437301959*^9, 3.925553512129795*^9, {3.925553555577448*^9, 
   3.925553558887321*^9}, {3.925553705268888*^9, 3.925553743333921*^9}, 
   3.925553810011917*^9, 3.925554115019619*^9, 3.925554286941289*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"d004743d-92b7-4f1b-85a7-972b0940fc9c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"B0", "=", "B0i"}], ",", 
       RowBox[{"c", "=", "ci"}], ",", 
       RowBox[{"\[CapitalLambda]z", "=", "\[CapitalLambda]z0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"p2", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[CapitalLambda]y", "-", "1"}], ",", "Jxi", ",", "Jx", 
              ",", "Jyi", ",", "Jy"}], "}"}], "/.", " ", "sols"}], "//.", 
           "rulesn"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", "zmax"}], ",", "zmax"}], "}"}], ",", 
         RowBox[{"PlotLegends", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalLambda]", "y"], "-", "1"}], ",", 
            SubscriptBox["J", 
             RowBox[{"x", ",", "i"}]], ",", 
            SubscriptBox["J", "x"], ",", 
            SubscriptBox["J", 
             RowBox[{"y", ",", "i"}]], ",", 
            SubscriptBox["J", "y"]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<figures/J_profiles.jpg\>\"", ",", "p2"}], "]"}], ";", 
      "\[IndentingNewLine]", "p2"}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ci", ",", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"B0i", ",", "2"}], "}"}], ",", "0.5", ",", "2"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\[CapitalLambda]z0", ",", "0", ",", "1"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zmax", ",", "10"}], "}"}], ",", "5", ",", "30"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.925430136018062*^9, 3.9254301472174063`*^9}, {
   3.925430228195335*^9, 3.925430257320425*^9}, {3.9254303112610693`*^9, 
   3.9254303693506403`*^9}, {3.925433473594613*^9, 3.925433478248987*^9}, {
   3.925433527658593*^9, 3.9254335277575607`*^9}, {3.925516148567726*^9, 
   3.9255162865622597`*^9}, 3.925516334755847*^9, {3.925552297400221*^9, 
   3.925552345839913*^9}, {3.9255526582252483`*^9, 3.925552680962762*^9}, {
   3.925552922212264*^9, 3.925552925247806*^9}, {3.925553359646388*^9, 
   3.925553362642268*^9}, {3.9255534436562843`*^9, 3.925553540052121*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"1b600b6f-1c13-43a5-93b8-c2a840bc13c2"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`B0i$$ = 2, $CellContext`ci$$ = 2^
    Rational[-1, 2], $CellContext`zmax$$ = 
    10, $CellContext`\[CapitalLambda]z0$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`ci$$], 2^Rational[-1, 2]}, 0, 2}, {{
       Hold[$CellContext`B0i$$], 2}, 0.5, 2}, {
      Hold[$CellContext`\[CapitalLambda]z0$$], 0, 1}, {{
       Hold[$CellContext`zmax$$], 10}, 5, 30}}, Typeset`size$$ = {
    656., {163., 170.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`B0i$$ = 2, $CellContext`ci$$ = 
        2^Rational[-1, 2], $CellContext`zmax$$ = 
        10, $CellContext`\[CapitalLambda]z0$$ = 0}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Block[{$CellContext`B0 = $CellContext`B0i$$, $CellContext`c = \
$CellContext`ci$$, $CellContext`\[CapitalLambda]z = $CellContext`\
\[CapitalLambda]z0$$}, $CellContext`p2 = Plot[
           Evaluate[
            ReplaceRepeated[
             
             ReplaceAll[{$CellContext`\[CapitalLambda]y - 
               1, $CellContext`Jxi, $CellContext`Jx, $CellContext`Jyi, \
$CellContext`Jy}, $CellContext`sols], $CellContext`rulesn]], {$CellContext`z, \
-$CellContext`zmax$$, $CellContext`zmax$$}, 
           PlotLegends -> {
            Subscript[$CellContext`\[CapitalLambda], $CellContext`y] - 1, 
             Subscript[$CellContext`J, $CellContext`x, $CellContext`i], 
             Subscript[$CellContext`J, $CellContext`x], 
             Subscript[$CellContext`J, $CellContext`y, $CellContext`i], 
             Subscript[$CellContext`J, $CellContext`y]}, PlotRange -> All]; 
        Export["figures/J_profiles.jpg", $CellContext`p2]; $CellContext`p2], 
      "Specifications" :> {{{$CellContext`ci$$, 2^Rational[-1, 2]}, 0, 
         2}, {{$CellContext`B0i$$, 2}, 0.5, 
         2}, {$CellContext`\[CapitalLambda]z0$$, 0, 
         1}, {{$CellContext`zmax$$, 10}, 5, 30}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{722., {292., 301.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.92543024539925*^9, 3.9254302716674633`*^9}, {
   3.9254303123029947`*^9, 3.92543036987113*^9}, 3.925430540247486*^9, 
   3.9254334802455683`*^9, {3.925433524434649*^9, 3.925433528412244*^9}, 
   3.9255143702666283`*^9, {3.925516187073655*^9, 3.925516198610867*^9}, 
   3.925516231564743*^9, {3.925516262014196*^9, 3.92551628741989*^9}, 
   3.925516336199719*^9, {3.9255228665047083`*^9, 3.925522872759089*^9}, {
   3.925552248939629*^9, 3.925552276997628*^9}, {3.925552308692829*^9, 
   3.9255523723394327`*^9}, 3.925553363118196*^9, 3.9255534477242517`*^9, {
   3.9255534881143847`*^9, 3.925553503654059*^9}, 3.925553542390811*^9, 
   3.925553814045981*^9, 3.925554117224513*^9, 3.92555428918547*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"fd7afa89-b04d-4fbb-9d81-5fe6e205a916"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T0", "=", "T0i"}], ",", 
       RowBox[{"c", "=", "ci"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"T", "[", "z", "]"}], "}"}], "/.", "sol"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", "zmax"}], ",", "zmax"}], "}"}], ",", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"{", "\"\<T\>\"", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ci", ",", "0.5"}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"T0i", ",", "1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zmax", ",", "10"}], "}"}], ",", "5", ",", "30"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9254277010752583`*^9, 3.925427776441703*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"41b57b6c-1923-4006-87f0-19ef00cb8469"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ci$$ = 0.5, $CellContext`T0i$$ = 
    1, $CellContext`zmax$$ = 10, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`ci$$], 0.5}, 0, 2}, {
      Hold[$CellContext`T0i$$], 1, 2}, {{
       Hold[$CellContext`zmax$$], 10}, 5, 30}}, Typeset`size$$ = {
    616., {163., 170.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ci$$ = 0.5, $CellContext`T0i$$ = 
        1, $CellContext`zmax$$ = 10}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Block[{$CellContext`T0 = $CellContext`T0i$$, $CellContext`c = \
$CellContext`ci$$}, 
        Plot[
         Evaluate[
          ReplaceAll[{
            $CellContext`T[$CellContext`z]}, $CellContext`sol]], \
{$CellContext`z, -$CellContext`zmax$$, $CellContext`zmax$$}, 
         PlotLegends -> {"T"}]], 
      "Specifications" :> {{{$CellContext`ci$$, 0.5}, 0, 
         2}, {$CellContext`T0i$$, 1, 2}, {{$CellContext`zmax$$, 10}, 5, 30}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{682., {272., 280.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.9254277134321833`*^9, 3.925427739660776*^9}, {
  3.925427771976142*^9, 3.9254277769432364`*^9}},
 CellLabel->"Out[81]=",ExpressionUUID->"d8bc5d68-aa82-4d89-9d8e-ff7fca277e1a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "system", " ", "of", " ", "equations"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", ":=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Bx", "[", "z", "]"}], ",", "z"}], "]"}], "==", 
      RowBox[{
       RowBox[{
        RowBox[{"n1", "[", "z", "]"}], " ", 
        RowBox[{"u1y", "[", "z", "]"}]}], "+", 
       RowBox[{"n2", " ", "u2y"}], "-", 
       RowBox[{"GammaE", " ", 
        RowBox[{
         RowBox[{"By", "[", "z", "]"}], "/", "Bz"}]}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eq2", ":=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"By", "[", "z", "]"}], ",", "z"}], "]"}], "==", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"n1", "[", "z", "]"}]}], " ", 
        RowBox[{"u1x", "[", "z", "]"}]}], "-", 
       RowBox[{"n2", " ", "u2x"}], "+", 
       RowBox[{"GammaE", " ", 
        RowBox[{
         RowBox[{"Bx", "[", "z", "]"}], "/", "Bz"}]}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eq3", ":=", 
     RowBox[{
      RowBox[{"Gamma1", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u1x", "[", "z", "]"}], ",", "z"}], "]"}]}], "==", 
      RowBox[{
       RowBox[{
        RowBox[{"n1", "[", "z", "]"}], " ", 
        RowBox[{"u1y", "[", "z", "]"}], " ", "Bz"}], "-", 
       RowBox[{"Gamma1", " ", 
        RowBox[{"By", "[", "z", "]"}]}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eq4", ":=", 
     RowBox[{
      RowBox[{"Gamma1", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u1y", "[", "z", "]"}], ",", "z"}], "]"}]}], "==", 
      RowBox[{
       RowBox[{"Gamma1", " ", 
        RowBox[{"Bx", "[", "z", "]"}]}], "-", 
       RowBox[{
        RowBox[{"n1", "[", "z", "]"}], " ", 
        RowBox[{"u1x", "[", "z", "]"}], " ", "Bz"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eq5", ":=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Gamma1", "^", "2"}], "/", 
           RowBox[{"n1", "[", "z", "]"}]}], "+", 
          RowBox[{"C1", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"n1", "[", "z", "]"}], "^", "\[Gamma]"}], "/", "2"}]}]}],
          ")"}], ",", "z"}], "]"}], "==", 
      RowBox[{
       RowBox[{"n1", "[", "z", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"u1x", "[", "z", "]"}], " ", 
          RowBox[{"By", "[", "z", "]"}]}], "-", 
         RowBox[{
          RowBox[{"u1y", "[", "z", "]"}], " ", 
          RowBox[{"Bx", "[", "z", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Te", "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", "ne"}], ")"}]}], " ", 
          RowBox[{"D", "[", 
           RowBox[{"ne", ",", "z"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ne", ":=", 
     RowBox[{"n2", "+", " ", 
      RowBox[{"n1", "[", "z", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"u1xInf", ":=", 
    RowBox[{"Gamma1", " ", 
     RowBox[{"BxInf", "/", 
      RowBox[{"(", 
       RowBox[{"n1Inf", " ", "Bz"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"u1yInf", ":=", 
    RowBox[{"Gamma1", " ", 
     RowBox[{"ByInf", "/", 
      RowBox[{"(", 
       RowBox[{"n1Inf", " ", "Bz"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bc1", "=", 
     RowBox[{
      RowBox[{"Bx", "[", "zmin", "]"}], "==", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bc2", ":=", 
     RowBox[{
      RowBox[{"n1", "[", "zmax", "]"}], "==", 
      RowBox[{"n1Inf", "+", "eps"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bc3", ":=", 
     RowBox[{
      RowBox[{"Bx", "[", "zmax", "]"}], "==", 
      RowBox[{"1", "-", "eps"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bc4", ":=", 
     RowBox[{
      RowBox[{"By", "[", "zmax", "]"}], "==", 
      RowBox[{"ByInf", "+", "eps"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bc6", ":=", 
     RowBox[{
      RowBox[{"u1y", "[", "zmax", "]"}], "==", 
      RowBox[{"u1yInf", "+", "eps"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bc5", ":=", 
     RowBox[{
      RowBox[{"u1x", "[", "zmax", "]"}], "==", 
      RowBox[{"u1xInf", "+", "eps"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BxInf", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]", "=", 
     RowBox[{"5", "/", "3"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"zmax", "=", "10"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eps", "=", "0.01"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.924985380279436*^9, 3.92498538028745*^9}, 
   3.924985424271101*^9, {3.924985595829688*^9, 3.9249855983260193`*^9}, {
   3.9249856412469378`*^9, 3.9249856538974953`*^9}, {3.9249857989507837`*^9, 
   3.9249858374960747`*^9}, {3.924985896629122*^9, 3.924985897084711*^9}, 
   3.9249859303916273`*^9, {3.924985987643427*^9, 3.924986028658383*^9}, {
   3.9249861264852877`*^9, 3.924986146066226*^9}, {3.924986189518632*^9, 
   3.924986189765711*^9}, {3.924989070604981*^9, 3.9249890830869217`*^9}, {
   3.924989137812544*^9, 3.92498914084431*^9}, {3.924989179508321*^9, 
   3.9249891800376377`*^9}, {3.924989258195839*^9, 3.924989280511724*^9}, 
   3.924989475101418*^9, {3.924989518130836*^9, 3.924989518477214*^9}, 
   3.924989787229409*^9, {3.924989830486578*^9, 3.92498983765237*^9}, {
   3.924989884368786*^9, 3.9249898845411177`*^9}, {3.924989919575602*^9, 
   3.924989920756763*^9}, {3.924990287546177*^9, 3.924990287959577*^9}, 
   3.9249925513731813`*^9, 3.92499410797484*^9, {3.924994214650003*^9, 
   3.924994217153739*^9}, {3.92499437190704*^9, 3.924994372206686*^9}, {
   3.924996055158443*^9, 3.9249960769179287`*^9}, {3.924996275737526*^9, 
   3.924996294425816*^9}, {3.9249963405610037`*^9, 3.92499634096539*^9}, 
   3.9249964729803057`*^9, {3.924998715026085*^9, 3.924998723913742*^9}, {
   3.924999048068433*^9, 3.924999048223363*^9}, {3.9249991582953157`*^9, 
   3.924999158528881*^9}, {3.925000358104835*^9, 3.925000365837809*^9}, {
   3.925000961979684*^9, 3.9250009636064587`*^9}, {3.925001193194249*^9, 
   3.9250011943715467`*^9}, {3.925001257685562*^9, 3.9250012832006283`*^9}, {
   3.925001886119255*^9, 3.9250018864846287`*^9}, {3.925001921520348*^9, 
   3.925001926871615*^9}, {3.9250021407021933`*^9, 3.92500215772014*^9}, {
   3.925002214260429*^9, 3.92500222020242*^9}, {3.925412947196602*^9, 
   3.925412951979897*^9}, {3.925413151451386*^9, 3.9254131517494287`*^9}, {
   3.925413971522797*^9, 3.9254139718477983`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"62ccb5da-23a7-46a7-8120-ad83400f5f9f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"n1Inf", ",", "\[IndentingNewLine]", 
       RowBox[{"Bz", "=", "BzInfC"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ByInf", " ", "=", " ", "ByInfC"}], ",", "\[IndentingNewLine]",
        "Gamma1", ",", "GammaE"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Solve", " ", "the", " ", "system", " ", "numerically"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n1Inf", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Alpha]n"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rules1", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u2x", "->", 
          RowBox[{
           RowBox[{"-", "\[Alpha]ux"}], " ", 
           RowBox[{"u1x", "[", "z", "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"u2y", "->", 
          RowBox[{
           RowBox[{"-", "\[Alpha]uy"}], " ", 
           RowBox[{"u1y", "[", "z", "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"n2", "->", 
          RowBox[{"\[Alpha]n", " ", 
           RowBox[{"n1", "[", "z", "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"C1", "->", 
          RowBox[{
           RowBox[{"2", "^", "\[Gamma]"}], " ", "beta1"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]ux", "->", "\[Alpha]u"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]uy", "->", "\[Alpha]u"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Te", "->", "TeC"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Gamma1", "=", 
       RowBox[{
        RowBox[{"-", "Bz"}], " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n1Inf", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"\[Alpha]n", "  ", 
             SuperscriptBox["\[Alpha]u", "2"]}]}], ")"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"GammaE", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Alpha]n", " ", "\[Alpha]u"}]}], ")"}], " ", "Gamma1"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"eqns", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5", ",", "bc2", 
          ",", "bc3", ",", "bc4", ",", "bc5", ",", "bc6"}], "}"}], "//.", 
        "rules1"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Test", "=", "True"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Test", "=", "False"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"Test", ",", "eqns", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sol", "=", 
          RowBox[{"NDSolve", "[", 
           RowBox[{"eqns", ",", 
            RowBox[{"{", 
             RowBox[{"Bx", ",", "By", ",", "u1x", ",", "u1y", ",", "n1"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "zmin", ",", "zmax"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"n1", "[", "z", "]"}], ",", 
               RowBox[{"Bx", "[", "z", "]"}], ",", 
               RowBox[{"By", "[", "z", "]"}], ",", 
               RowBox[{"u1x", "[", "z", "]"}], ",", 
               RowBox[{"u1y", "[", "z", "]"}], ",", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"Bx", "[", "z", "]"}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"By", "[", "z", "]"}], ")"}], "2"]}], "]"}]}], 
              "}"}], "/.", " ", "sol"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "zmin", ",", "zmax"}], "}"}], ",", 
           RowBox[{"PlotLegends", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<n[z]\>\"", ",", "\"\<Bx[z]\>\"", ",", "\"\<By[z]\>\"", ",", 
              "\"\<ux[z]\>\"", ",", "\"\<uy[z]\>\"", ",", "\"\<B[z]\>\""}], 
             "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"BzInfC", ",", "0.1"}], "}"}], ",", "0", ",", "2"}], "}"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ByInfC", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zmin", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "zmax"}], ",", "zmax"}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"{", 
    RowBox[{"beta1", ",", 
     RowBox[{"1", "/", "2"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]u", " ", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]n", ",", "1"}], "}"}], ",", "0.5", ",", "1"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"TeC", ",", "0", ",", "10"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.924984627377318*^9, 3.924984641615819*^9}, {
   3.9249848819604263`*^9, 3.924984905816361*^9}, {3.9249850400244303`*^9, 
   3.924985048203691*^9}, {3.924985199224421*^9, 3.924985199401761*^9}, {
   3.924985408452303*^9, 3.924985412711576*^9}, {3.9249855898646383`*^9, 
   3.924985614284128*^9}, {3.9249856559516783`*^9, 3.924985666365116*^9}, {
   3.9249858244473057`*^9, 3.924985875214773*^9}, {3.9249859128492804`*^9, 
   3.924986145029091*^9}, {3.924986192342289*^9, 3.924986204373991*^9}, {
   3.924986295339068*^9, 3.924986373577174*^9}, {3.9249864102425756`*^9, 
   3.924986471281789*^9}, {3.924986526607518*^9, 3.924986547905657*^9}, {
   3.924986591296638*^9, 3.924986640662141*^9}, 3.9249866751474047`*^9, {
   3.924986751235688*^9, 3.924986759723012*^9}, {3.924986895444172*^9, 
   3.924986926588173*^9}, {3.924987369811976*^9, 3.924987413827456*^9}, 
   3.924987449292404*^9, {3.924987763912162*^9, 3.9249878833575687`*^9}, {
   3.9249880628517113`*^9, 3.9249881338426733`*^9}, {3.924988186661049*^9, 
   3.9249882959514027`*^9}, {3.924988335580003*^9, 3.9249883431131907`*^9}, {
   3.924988381968371*^9, 3.924988459761877*^9}, {3.924988520289854*^9, 
   3.924988598557087*^9}, {3.924989114542739*^9, 3.924989119261738*^9}, 
   3.924989149852427*^9, {3.9249892372495537`*^9, 3.924989237978685*^9}, {
   3.924989288935646*^9, 3.9249893227418756`*^9}, 3.924989358343709*^9, {
   3.924989455519065*^9, 3.924989527496173*^9}, {3.9249896928721*^9, 
   3.924989736702712*^9}, {3.924989780072988*^9, 3.924989828603243*^9}, {
   3.924989882861536*^9, 3.924989915723133*^9}, 3.924990099000598*^9, {
   3.924990152032305*^9, 3.9249901672613087`*^9}, {3.924990203007869*^9, 
   3.9249902964966908`*^9}, {3.924990344315752*^9, 3.924990509960272*^9}, {
   3.92499054039435*^9, 3.924990720345194*^9}, 3.924990911276479*^9, {
   3.924990944432397*^9, 3.924990944536603*^9}, {3.924990996190221*^9, 
   3.924990997668676*^9}, 3.92499105438691*^9, {3.92499129800305*^9, 
   3.92499131582185*^9}, {3.924991360927652*^9, 3.924991407559733*^9}, {
   3.924991697640101*^9, 3.924991718009478*^9}, {3.924991856821817*^9, 
   3.924991867214013*^9}, 3.924992260506435*^9, 3.924992341158504*^9, {
   3.924992541381446*^9, 3.9249925452956047`*^9}, {3.924992662635214*^9, 
   3.924992715229076*^9}, {3.924994005535268*^9, 3.924994006034601*^9}, {
   3.9249941458793*^9, 3.924994151929636*^9}, {3.92499436432771*^9, 
   3.924994468752993*^9}, {3.9249945097590857`*^9, 3.9249945256147947`*^9}, {
   3.9249945757878113`*^9, 3.924994584131027*^9}, {3.924994625931184*^9, 
   3.92499462774995*^9}, {3.924995311209242*^9, 3.9249953113190823`*^9}, {
   3.92499542977726*^9, 3.9249954365493717`*^9}, {3.924995676884227*^9, 
   3.924995677470537*^9}, {3.924995768925625*^9, 3.924995771101626*^9}, {
   3.924995853371777*^9, 3.924995856559091*^9}, {3.924995936739119*^9, 
   3.924995968048615*^9}, 3.924996052771557*^9, {3.924996110051402*^9, 
   3.924996122859441*^9}, {3.9249961817295856`*^9, 3.9249962242127953`*^9}, {
   3.9249962651110783`*^9, 3.9249962659291067`*^9}, {3.924996320584218*^9, 
   3.924996336596656*^9}, {3.9249964406468287`*^9, 3.924996465341049*^9}, {
   3.924998590185741*^9, 3.92499859895965*^9}, {3.924998649342004*^9, 
   3.924998656948819*^9}, {3.9249987761048822`*^9, 3.924998790238471*^9}, {
   3.9249990455614233`*^9, 3.924999165357278*^9}, {3.924999221315134*^9, 
   3.9249992218469143`*^9}, 3.9249993009477873`*^9, {3.924999341334697*^9, 
   3.924999343579277*^9}, {3.92499943733409*^9, 3.924999487031239*^9}, 
   3.924999603751309*^9, {3.924999636003042*^9, 3.924999701240193*^9}, {
   3.924999745582202*^9, 3.924999748002*^9}, 3.9249999607170277`*^9, 
   3.9250000034123573`*^9, {3.9250001474194393`*^9, 3.9250001854563503`*^9}, 
   3.925000215855322*^9, {3.9250002740807037`*^9, 3.925000294988741*^9}, {
   3.925000338827415*^9, 3.925000339202921*^9}, {3.925000377735694*^9, 
   3.925000411922523*^9}, {3.925000449297895*^9, 3.925000494019991*^9}, {
   3.925000524797703*^9, 3.925000525126779*^9}, {3.925000563369735*^9, 
   3.925000655589127*^9}, 3.9250006993208933`*^9, 3.9250009173693733`*^9, {
   3.925000959680825*^9, 3.925000960034178*^9}, {3.92500105538102*^9, 
   3.92500108623186*^9}, {3.925001303460121*^9, 3.925001315920311*^9}, 
   3.925001347366932*^9, {3.9250013880158567`*^9, 3.9250014368446503`*^9}, {
   3.925001480641254*^9, 3.925001520045315*^9}, {3.925001687680234*^9, 
   3.92500168799146*^9}, {3.9250017208812847`*^9, 3.925001739343624*^9}, 
   3.925001804782136*^9, 3.92500194174219*^9, {3.925002115901648*^9, 
   3.9250021161676197`*^9}, {3.925002148091113*^9, 3.925002148546405*^9}, 
   3.925002249381177*^9, 3.925002356691107*^9, {3.925413438491287*^9, 
   3.92541343919398*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"958415e6-db89-4d32-a343-ce802d19575a"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`beta1$$ = Rational[
    1, 2], $CellContext`ByInfC$$ = 2., $CellContext`BzInfC$$ = 
    0.1, $CellContext`TeC$$ = 
    0, $CellContext`zmin$$ = -2.2199999999999998`, $CellContext`\[Alpha]n$$ = 
    1, $CellContext`\[Alpha]u$$ = 0.122, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`BzInfC$$], 0.1}, 0, 2}, {{
       Hold[$CellContext`ByInfC$$], 0}, -2, 2}, {{
       Hold[$CellContext`zmin$$], 0}, -10, 10}, {
      Hold[$CellContext`beta1$$], 
      Rational[1, 2], 1}, {{
       Hold[$CellContext`\[Alpha]u$$], 1}, 0, 2}, {{
       Hold[$CellContext`\[Alpha]n$$], 1}, 0.5, 1}, {
      Hold[$CellContext`TeC$$], 0, 10}}, Typeset`size$$ = {
    923.6, {159.4638671875, 21.528076171875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`beta1$$ = 
        Rational[1, 2], $CellContext`ByInfC$$ = 0, $CellContext`BzInfC$$ = 
        0.1, $CellContext`TeC$$ = 0, $CellContext`zmin$$ = 
        0, $CellContext`\[Alpha]n$$ = 1, $CellContext`\[Alpha]u$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Block[{$CellContext`n1Inf, $CellContext`Bz = $CellContext`BzInfC$$, \
$CellContext`ByInf = $CellContext`ByInfC$$, $CellContext`Gamma1, \
$CellContext`GammaE}, $CellContext`n1Inf = 
         1/(1 + $CellContext`\[Alpha]n$$); $CellContext`rules1 = \
{$CellContext`u2x -> (-$CellContext`\[Alpha]ux) \
$CellContext`u1x[$CellContext`z], $CellContext`u2y -> \
(-$CellContext`\[Alpha]uy) $CellContext`u1y[$CellContext`z], $CellContext`n2 -> \
$CellContext`\[Alpha]n$$ $CellContext`n1[$CellContext`z], $CellContext`C1 -> 
           2^$CellContext`\[Gamma] $CellContext`beta1$$, \
$CellContext`\[Alpha]ux -> $CellContext`\[Alpha]u$$, $CellContext`\[Alpha]uy -> \
$CellContext`\[Alpha]u$$, $CellContext`Te -> $CellContext`TeC$$}; \
$CellContext`Gamma1 = (-$CellContext`Bz) 
          Sqrt[$CellContext`n1Inf/(
            1 + $CellContext`\[Alpha]n$$ $CellContext`\[Alpha]u$$^2)]; \
$CellContext`GammaE = (
           1 - $CellContext`\[Alpha]n$$ $CellContext`\[Alpha]u$$) \
$CellContext`Gamma1; $CellContext`eqns = 
         ReplaceRepeated[{$CellContext`eq1, $CellContext`eq2, \
$CellContext`eq3, $CellContext`eq4, $CellContext`eq5, $CellContext`bc2, \
$CellContext`bc3, $CellContext`bc4, $CellContext`bc5, $CellContext`bc6}, \
$CellContext`rules1]; $CellContext`Test = True; $CellContext`Test = False; 
        If[$CellContext`Test, $CellContext`eqns, $CellContext`sol = 
           NDSolve[$CellContext`eqns, {$CellContext`Bx, $CellContext`By, \
$CellContext`u1x, $CellContext`u1y, $CellContext`n1}, {$CellContext`z, \
$CellContext`zmin$$, $CellContext`zmax}]; Plot[
            Evaluate[
             ReplaceAll[{
               $CellContext`n1[$CellContext`z], 
               $CellContext`Bx[$CellContext`z], 
               $CellContext`By[$CellContext`z], 
               $CellContext`u1x[$CellContext`z], 
               $CellContext`u1y[$CellContext`z], 
               
               Sqrt[$CellContext`Bx[$CellContext`z]^2 + \
$CellContext`By[$CellContext`z]^2]}, $CellContext`sol]], {$CellContext`z, \
$CellContext`zmin$$, $CellContext`zmax}, 
            PlotLegends -> {
             "n[z]", "Bx[z]", "By[z]", "ux[z]", "uy[z]", "B[z]"}]]], 
      "Specifications" :> {{{$CellContext`BzInfC$$, 0.1}, 0, 
         2}, {{$CellContext`ByInfC$$, 0}, -2, 
         2}, {{$CellContext`zmin$$, 0}, -10, 10}, {$CellContext`beta1$$, 
         Rational[1, 2], 1}, {{$CellContext`\[Alpha]u$$, 1}, 0, 
         2}, {{$CellContext`\[Alpha]n$$, 1}, 0.5, 1}, {$CellContext`TeC$$, 0, 
         10}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1118., {278., 287.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.925000255848186*^9, 3.925000295656563*^9, 3.925000339804666*^9, {
   3.92500040393187*^9, 3.925000412412341*^9}, {3.9250004714027157`*^9, 
   3.925000476520206*^9}, 3.925000563941309*^9, {3.925000594188159*^9, 
   3.9250006103620367`*^9}, {3.9250006447826567`*^9, 3.925000656111665*^9}, 
   3.925001057448358*^9, {3.925001291093719*^9, 3.925001316464739*^9}, 
   3.9250013477873774`*^9, {3.9250013884497337`*^9, 3.9250014373311462`*^9}, {
   3.925001490959139*^9, 3.9250015333594627`*^9}, {3.925001724789259*^9, 
   3.925001739829803*^9}, {3.925001797175026*^9, 3.925001805122374*^9}, 
   3.925001853011054*^9, 3.925001889190102*^9, {3.925001932555067*^9, 
   3.925001942092991*^9}, 3.925002129415051*^9, {3.925002230272053*^9, 
   3.9250022499220543`*^9}, {3.9250023007016973`*^9, 3.925002357183066*^9}, 
   3.9252333249515676`*^9, 3.925241243854665*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"fc59f2eb-55ab-4e26-9b74-f0fb66fa3a76"]
}, Open  ]]
},
WindowSize->{1280, 1412},
WindowMargins->{{-2560, Automatic}, {-223, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
CellContext->Notebook,
Magnification->1.5,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e4394968-4120-430b-9412-4643b14d6f31"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 523, 13, 78, "Input",ExpressionUUID->"c57be7b1-9b08-4fef-857d-8b76f19ba880"],
Cell[1084, 35, 1237, 30, 140, "Input",ExpressionUUID->"2a549da3-f222-4fa3-b368-545cb805d6b5"],
Cell[2324, 67, 918, 23, 49, "Input",ExpressionUUID->"9f4efdb5-9f57-44e4-a8f0-abf996ab31d8"],
Cell[3245, 92, 1114, 27, 104, "Input",ExpressionUUID->"60b358ca-ec4d-4958-93d6-f654c4b1f51e"],
Cell[4362, 121, 3770, 99, 353, "Input",ExpressionUUID->"1589de5a-f673-450d-9fe5-baabdbfccd22"],
Cell[CellGroupData[{
Cell[8157, 224, 1402, 32, 140, "Input",ExpressionUUID->"0ee476ad-e9a5-4366-8c40-8c4f2ea34276"],
Cell[9562, 258, 825, 15, 76, "Output",ExpressionUUID->"6524e740-094b-444b-9944-877c6752f301"],
Cell[10390, 275, 2023, 60, 177, "Output",ExpressionUUID->"7f51e274-2f5a-4822-ad3b-8fc2ec5f6c0f"]
}, Open  ]],
Cell[12428, 338, 1366, 34, 264, "Input",ExpressionUUID->"43160a05-28e8-481e-a28b-2c0263eb43e1"],
Cell[13797, 374, 199, 3, 53, "Text",ExpressionUUID->"51c5f021-c743-4d0a-b04e-c3919d509d8b"],
Cell[CellGroupData[{
Cell[14021, 381, 5778, 105, 467, "Input",ExpressionUUID->"75d50e55-db95-43e3-a1d2-b2204956fced"],
Cell[19802, 488, 4057, 71, 580, "Output",ExpressionUUID->"d004743d-92b7-4f1b-85a7-972b0940fc9c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23896, 564, 2881, 70, 408, "Input",ExpressionUUID->"1b600b6f-1c13-43a5-93b8-c2a840bc13c2"],
Cell[26780, 636, 3757, 69, 638, "Output",ExpressionUUID->"fd7afa89-b04d-4fbb-9d81-5fe6e205a916"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30574, 710, 1273, 34, 264, "Input",ExpressionUUID->"41b57b6c-1923-4006-87f0-19ef00cb8469"],
Cell[31850, 746, 2207, 46, 580, "Output",ExpressionUUID->"d8bc5d68-aa82-4d89-9d8e-ff7fca277e1a"]
}, Open  ]],
Cell[34072, 795, 6852, 175, 729, "Input",ExpressionUUID->"62ccb5da-23a7-46a7-8120-ad83400f5f9f"],
Cell[CellGroupData[{
Cell[40949, 974, 10504, 208, 1348, "Input",ExpressionUUID->"958415e6-db89-4d32-a343-ce802d19575a"],
Cell[51456, 1184, 5584, 101, 593, "Output",ExpressionUUID->"fc59f2eb-55ab-4e26-9b74-f0fb66fa3a76"]
}, Open  ]]
}
]
*)

